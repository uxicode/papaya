<section class="contents-right">
  <div class="classes-feed notification" v-if="isPageLoaded">
    <div class="cnt-top">
      <h2 class="cnt-tit">알림</h2>
      <div class="cnt-top-btn">
        <!--<v-menu
                     top  //absolute 위치로 상단 정렬
                     nudge-bottom="40px" // 하단을 기준으로 추가 px 조절
                     nudge-left="30px" // 좌측을 기준으로 추가 px 조절 수치가 클수록 왼쪽으로 배치된다.
                     origin="center center"  // transform-origin
                     v-model="timeMenu"  // value 값으로 노출
                     :close-on-content-click // 값이 true -> 메뉴의 컨텐츠를 클릭하면 메뉴를 닫음
                     :close-on-click  //값이 true -> 활성자의 바깥을 클릭하면 메뉴를 닫음
                     transition="scale-transition" // 스케일 모션
                     content-class="time-select-menu bg-white" // 해당 메뉴에 추가 클래스
                     offset-y   // 메뉴 버튼을 중심으로 y 값으로 정렬 배치
                     -->
        <v-menu
                origin="left top"
                v-model="startDateMenu"
                :close-on-content-click="false"
                transition="scale-transition"
                offset-y
                min-width="auto">
          <template v-slot:activator="{ on, attrs }">
            <button type="button" class="btn form-btn form-calendar" v-on="on"></button>
          </template>
          <!-- no-title //상단에 타이틀 성격의 날짜 없앰  hide-details  상세 텍스트 제거 -->
          <v-date-picker v-model="startDatePickerModel" no-title @input="startDatePickerChange"></v-date-picker>
        </v-menu>

      </div>
    </div>
    <div class="top-notify">
      <div class="accordion">
        <!-- accordion 1-->
        <div class="accordion-tit">
          <a href="javascript:void(0);" class="accordion-btn active" data-toggle="collapse" data-target="#accordion1">
            <span class="icon"><img :src="require('@/assets/images/time-outline.svg')" class="icon-img" alt=""></span>
            <span class="mgl-4">{{ reservedTotal }}개의 예약 알림이 있습니다.</span>
          </a>
        </div>

        <div class="accordion-cnt active" id="accordion1" v-if="reservedTotal>0">
          <div class="notify-feed" v-for="item in reservedItems">
            <h3 class="fd-tit">{{ item.title }}</h3>
            <p class="fd-schedule">오후 11시에 등록 예정</p>
            <div class="fd-btn">
              <div class="list-popup">
                <button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
                <div class="list-popup-menu pos-right active"  style="transform:translate3d(35px, 0, 0);">
                  <a href="" class="list-popup-item">알림 수정</a>
                  <a href="" class="list-popup-item">공지로 등록</a>
                  <a href="" class="list-popup-item">알림 보관</a>
                  <a href="" class="list-popup-item">알림 삭제</a>
                </div>
              </div>
            </div>
          </div>

          <div class="notify-feed">
            <h3 class="fd-tit">2학기 전학년 전과목 평가계획안</h3>
            <p class="fd-schedule">내일 오후 2시 50분에 등록 예정</p>
            <div class="fd-btn">
              <div class="list-popup">
                <button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
                <div class="list-popup-menu pos-right"  style="transform:translate3d(35px, 0, 0);">
                  <a href="" class="list-popup-item">알림 수정</a>
                  <a href="" class="list-popup-item">공지로 등록</a>
                  <a href="" class="list-popup-item">알림 보관</a>
                  <a href="" class="list-popup-item">알림 삭제</a>
                </div>
              </div>
            </div>
          </div>

          <div class="notify-feed">
            <h3 class="fd-tit">파파야 초등학교 기간제교사 채용 공고</h3>
            <p class="fd-schedule">2020. 4. 21 오전 11시 30분에 등록 예정</p>
            <div class="fd-btn">
              <div class="list-popup">
                <button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
                <div class="list-popup-menu pos-right"  style="transform:translate3d(35px, 0, 0);">
                  <a href="" class="list-popup-item">알림 수정</a>
                  <a href="" class="list-popup-item">공지로 등록</a>
                  <a href="" class="list-popup-item">알림 보관</a>
                  <a href="" class="list-popup-item">알림 삭제</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- //accordion 1-->
      </div>
    </div>

    <div v-if="postListItemsModel.length>0">
      <div class="feed-item" v-for="(item, index) in postListItemsModel" :key="`notice-${index}`">
        <div class="fd-head">
          <h3 class="fd-tit">{{ item.title }}</h3>
          <div class="fd-writer type2">
            <p class="writer">
              <span class="name" :class="{'manager':isOwner( item.owner.user_id, item.user_id)}">{{ item.owner.nickname }}</span>
              <span class="time">{{ item.updatedAt }}</span>
              <span class="noti">{{ item.type===0? '일반' : '공지' }}</span>
            </p>
          </div>
          <div class="fd-btn">
            <button type="button" class="btn only-ico-btn sm bookmark" :class="{'active': item.isBookmark }" @click="onKeepPostClick(item.id)"></button>
            <div class="list-popup">
              <v-menu
                      min-width="200px"
                      :close-on-click="true">
                <template v-slot:activator="{ on, attrs }">
                  <button v-if="isOwner( item.owner.user_id, item.user_id)"
                          type="button"
                          class="list-popup-btn"
                          v-bind="attrs"
                          v-on="on"><img :src="require('@/assets/images/more.svg')" alt="">
                  </button>
                </template>
                <v-list>
                  <v-list-item @click="">
                    <v-list-item-title>일정 수정</v-list-item-title>
                  </v-list-item>
                  <v-list-item @click="">
                    <v-list-item-title>공지로 등록</v-list-item-title>
                  </v-list-item>
                  <v-list-item @click="">
                    <v-list-item-title>일정 보관</v-list-item-title>
                  </v-list-item>
                  <v-list-item @click="">
                    <v-list-item-title>일정 삭제</v-list-item-title>
                  </v-list-item>
                </v-list>
              </v-menu>
              <!--<button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
              <div class="list-popup-menu pos-right"  style="transform:translate3d(35px, 0, 0);">
                <a href="" class="list-popup-item">알림 수정</a>
                <a href="" class="list-popup-item">공지로 등록</a>
                <a href="" class="list-popup-item">알림 보관</a>
                <a href="" class="list-popup-item">알림 삭제</a>
              </div>-->
            </div>
          </div>
        </div>
        <div class="fd-cnt">
          <p class="fd-txt">
              <a href="" @click.prevent="onDetailPostPopupOpen(item.id)">{{ item.text }}</a>
          </p>

          <div class="fd-inner">

            <!-- start: attach 에 이미지파일이 있는 경우 -->
            <template v-if="getImgFileLen(item.attachment)>0">
              <ul class="img-list clearfix">
                <li class="img-item" v-for="( imgItem, imgIndex ) in getImgFileDataSort(item.attachment)"
                    :key="`img-${imgIndex}`" >
                  <a :href="imgItem.location"
                     :data-count="getImgFileMoreCheck(item.attachment)"
                     :class="{'pseudo-del': getImgTotalNum(item.attachment) }">
                    <img :src="imgItem.location" alt="">
                  </a>
                </li>
              </ul>
            </template>
            <!-- end: attach 에 이미지파일이 있는 경우 -->

            <!-- start: attach 에 이미지 말고 다른 확장자를 가진 파일 즉 첨부파일인 경우 -->
            <template v-if="getFileDataSort(item.attachment).length>0">
              <p class="fd-inner-txt">첨부 파일 {{ getFileDataSort(item.attachment).length }}</p>
              <ul class="file-list clearfix">
                <li v-for="fileItem in getFileDataSort(item.attachment)"><a :href="fileItem.location">{{fileItem.originalname }}</a></li>
              </ul>
            </template>
            <!-- end: attach 에 이미지 말고 다른 확장자를 가진 파일 즉 첨부파일인 경우 -->

            <!-- start:  투표가 있는 경우 -->
            <template v-if="item.vote!==null">
              <p class="fd-inner-txt fc-red">{{ isVote(item.vote.finishAt)? '투표 중' : '투표마감'}}</p>
              <div class="vote-area">
                <p class="vote-tit">{{ item.vote.title }}</p>
                <ul class="vote-option clearfix">
                  <li>{{ (item.vote.multi_choice)? '복수선택' : '단일선택'}}</li>
                  <li>{{ (item.vote.anonymous_mode)? '익명투표' : '공개투표' }}</li>
                  <li>{{ (item.vote.finishAt)? item.vote.finishAt+' 마감': '종료일자없음'}} </li>
                </ul>
              </div>
            </template>
            <!-- end:  투표가 있는 경우 -->

            <!--<p class="fd-inner-txt">미술대회 관련 링크 1</p>

            <div class="link-area">
              <div class="link-thumb"><img :src="require('@/assets/images/pic4.png')" alt=""></div>
              <div class="link-cnt">
                <p class="link-tit">2019학년도 초등미술경시대회 일정 및 안내</p>
                <p class="link-txt">자연사랑 어린이 미술대회는 지난 2016년부터 개최해 온 전통 있는 미술대회 입니다. 아이들에게 환경보호…</p>
                <p class="link-source"><img :src="require('@/assets/images/pic9.png')" class="link-logo" alt="">https://m.blog.naver.com/ccedulab/221457750462214577504622145775046</p>
              </div>
            </div>-->

          </div>
        </div>

        <div class="fd-foot clearfix">
          <span class="fd-viewer">{{ item.count }}명 읽음</span>
          <span class="fd-comment">댓글 {{ getCommentTotal( item.id ) }}</span>
        </div>
      </div>

     <!-- <div class="feed-item">
        <div class="fd-head">
          <h3 class="fd-tit">6학년 2학기 수학 II 3단원</h3>
          <div class="fd-writer type2">
            <p class="writer">
              <span class="name">박수한선생님</span>
              <span class="time">2시간 전</span>
            </p>
          </div>
          <div class="fd-btn">
            <button type="button" class="btn only-ico-btn sm bookmark"></button>
            <div class="list-popup">
              <button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
              <div class="list-popup-menu pos-right"  style="transform:translate3d(35px, 0, 0);">
                <a href="" class="list-popup-item">알림 수정</a>
                <a href="" class="list-popup-item">공지로 등록</a>
                <a href="" class="list-popup-item">알림 보관</a>
                <a href="" class="list-popup-item">알림 삭제</a>
              </div>
            </div>
          </div>
        </div>
        <div class="fd-cnt">
          <p class="fd-txt">새로운 교육과정이 등록되었습니다.</p>
          <p class="fd-txt">총 12회의 수업이 있습니다.</p>

          <div class="fd-inner">
            <p class="fd-inner-txt">첨부 파일 3</p>

            <ul class="file-list clearfix">
              <li><a href="">6학년 2학기 수학 II 3단원 .pdf</a></li>
              <li><a href="">수학 II 3단원 정리 .hwp</a></li>
              <li><a href="">수학 I 개념 정리.pdf</a></li>
            </ul>
          </div>
        </div>
        <div class="fd-foot clearfix">
          <span class="fd-viewer">124명 읽음</span>
          <span class="fd-comment">댓글 12</span>
        </div>
      </div>

      <div class="feed-item">
        <div class="fd-head">
          <h3 class="fd-tit">수학여행 장소 투표 부탁드립니다.</h3>
          <div class="fd-writer type2">
            <p class="writer">
              <span class="name crown">김미영선생님</span>
              <span class="time">2019.12.11</span>
            </p>
          </div>
          <div class="fd-btn">
            <button type="button" class="btn only-ico-btn sm bookmark"></button>
            <div class="list-popup">
              <button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
              <div class="list-popup-menu pos-right"  style="transform:translate3d(35px, 0, 0);">
                <a href="" class="list-popup-item">알림 수정</a>
                <a href="" class="list-popup-item">공지로 등록</a>
                <a href="" class="list-popup-item">알림 보관</a>
                <a href="" class="list-popup-item">알림 삭제</a>
              </div>
            </div>
          </div>
        </div>
        <div class="fd-cnt">
          <p class="fd-txt">
            어디로 가야 하는지 지도와 나침반이 있어야 올바른 길로 올바른 속도로 그리고 올바른 방향으로 갈 수 있죠. 공부에 있어서는 목차가 그러한데요. 오늘은 수학 II 목차를 3단원 내용 모두 다 정리해보려고 합니다.
          </p>
          <p class="fd-txt">
            첨부된 파일 확인 부탁드립니다.
          </p>

          <div class="fd-inner">
            <p class="fd-inner-txt fc-red">투표 중</p>

            <div class="vote-area">
              <p class="vote-tit">미술박물관 관람일 투표</p>
              <ul class="vote-option clearfix">
                <li>복수선택</li>
                <li>익명투표</li>
                <li>2020.3.12 오후 3시 마감</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="fd-foot clearfix">
          <span class="fd-viewer">124명 읽음</span>
          <span class="fd-comment">댓글 12</span>
        </div>
      </div>

      <div class="feed-item">
        <div class="fd-head">
          <h3 class="fd-tit">수학여행 장소 투표 부탁드립니다.</h3>
          <div class="fd-writer type2">
            <p class="writer">
              <span class="name crown">김미영선생님</span>
              <span class="time">2019.12.10</span>
            </p>
          </div>
          <div class="fd-btn">
            <button type="button" class="btn only-ico-btn sm bookmark"></button>
            <div class="list-popup">
              <button type="button" class="list-popup-btn"><img :src="require('@/assets/images/more.svg')" alt=""></button>
              <div class="list-popup-menu pos-right"  style="transform:translate3d(35px, 0, 0);">
                <a href="" class="list-popup-item">알림 수정</a>
                <a href="" class="list-popup-item">공지로 등록</a>
                <a href="" class="list-popup-item">알림 보관</a>
                <a href="" class="list-popup-item">알림 삭제</a>
              </div>
            </div>
          </div>
        </div>
        <div class="fd-cnt">
          <p class="fd-txt">
            자연사랑 어린이 미술대회는 지난 2016년부터 개최해 온 전통 있는 미술대회 입니다.
          </p>
          <p class="fd-txt">
            아이들에게 환경보호의 중요성을 전달함은 물론 미술교육의 발전에 기여하고자 그동안 금강산 미술 소풍, 학교숲, 중국학생 참가 등 많은 에피소드를 만들며 3년째 진행되어 왔으며 전국에서 매년 3만명 이상의 어린이들이 참가하여 대한민국 대표 어린이 미술대회로 자리매김하였습니다.
          </p>
          <p class="fd-txt">
            자세한 내용은 아래에 링크를 첨부하였으니, 관심 있으신 학부모 및 학생들은 확인…
          </p>

          <div class="fd-inner">
            <p class="fd-inner-txt">미술대회 관련 링크 1</p>

            <div class="link-area">
              <div class="link-thumb"><img :src="require('@/assets/images/pic4.png')" alt=""></div>
              <div class="link-cnt">
                <p class="link-tit">2019학년도 초등미술경시대회 일정 및 안내</p>
                <p class="link-txt">자연사랑 어린이 미술대회는 지난 2016년부터 개최해 온 전통 있는 미술대회 입니다. 아이들에게 환경보호…</p>
                <p class="link-source"><img :src="require('@/assets/images/pic9.png')" class="link-logo" alt="">https://m.blog.naver.com/ccedulab/221457750462214577504622145775046</p>
              </div>
            </div>
          </div>
        </div>
        <div class="fd-foot clearfix">
          <span class="fd-viewer">124명 읽음</span>
          <span class="fd-comment">댓글 12</span>
        </div>
      </div>-->

      <div class="noti-add">
        <a href="" class="classes-add-btn" @click.prevent="onAddPostPopupOpen"></a>
      </div>
    </div>

    <!-- 등록된 알림 없음 -->
    <div class="no-notify" v-else>
        <div class="no-data">
            <img :src="require('@/assets/images/icn-80-notice-nodata.svg')" alt="">
            <p>등록된 알림이 없습니다.</p>
            <span>새 알림을 작성해 주세요.</span>
            <div class="mgt-20">
                <button type="button" class="btn primary navi">새 알림 작성</button>
            </div>
        </div>

        <div class="noti-add">
            <a href="" class="classes-add-btn" @click.prevent="onAddPostPopupOpen"></a>
        </div>
    </div>
  </div>

  <notify-detail-popup :is-open="isDetailPopupOpen" @change="onDetailPostPopupStatus"></notify-detail-popup>
  <add-notify-popup :is-open="isAddPopupOpen" @change="onAddPostPopupStatus" @submit="onAddPost"></add-notify-popup>
</section>
