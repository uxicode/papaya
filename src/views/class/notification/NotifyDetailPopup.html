<div>
    <transition name="modal">
        <!-- start: 공통 팝업 / 파일명 : W.4.5.2.4 (알림 상세) -->
        <modal v-if="isOpen" size="600px" body-padding="0" @modalClose="popupChange(false)">
            <template v-if="postDetailModel!==undefined">
                <div slot="header">
                    <!-- header custom coding-->
                    <p class="popup-header-tit">{{ postDetailModel.title }}</p>
                    <ul class="feed-info clearfix">
                        <li>{{ postDetailModel.createdAt }}</li>
                        <li>{{ postDetailModel.count }}명 읽음</li>
                    </ul>

                    <div class="popup-btn">
                        <button type="button" class="btn only-ico-btn sm bookmark active"></button>

                        <div class="list-popup mgl-20">
                            <v-menu
                                    min-width="200px"
                                    :close-on-click="true">
                                <template v-slot:activator="{ on, attrs }">
                                    <button v-if="true"
                                            type="button"
                                            class="list-popup-btn"
                                            v-bind="attrs"
                                            v-on="on"><img :src="require('@/assets/images/more.svg')" alt="">
                                    </button>
                                </template>
                                <v-list>
                                    <v-list-item @click="">
                                        <v-list-item-title>일정 수정</v-list-item-title>
                                    </v-list-item>
                                    <v-list-item @click="">
                                        <v-list-item-title>공지로 등록</v-list-item-title>
                                    </v-list-item>
                                    <v-list-item @click="">
                                        <v-list-item-title>일정 보관</v-list-item-title>
                                    </v-list-item>
                                    <v-list-item @click="">
                                        <v-list-item-title>일정 삭제</v-list-item-title>
                                    </v-list-item>
                                </v-list>
                            </v-menu>
                        </div>
                    </div>
                </div>
                <div slot="body">
                    <!-- body custom coding-->
                    <div class="scroll-body" style="height:50vh">

                        <div class="popup-form">
                            <div class="popup-form-top">
                                <div class="form-item post-classes selected"> <!-- class 선택 시 form-item에 selected 추가됨 -->
                                    <p>
                                        <span class="icon"><img :src="require('@/assets/images/bg-icon.png')" class="icon-img" alt=""></span>
                                        <span class="gr-name">{{ myClassHomeModel.g_name }}</span>
                                        <strong class="cls-name">{{ myClassHomeModel.name }}</strong>
                                    </p>

                                    <p class="post-writer">{{ ( postDetailModel)? postDetailModel.owner.nickname : '' }}</p>
                                </div>
                            </div>
                        </div>

                        <div class="popup-feed-detail pdb-40" style="min-height:30vh">
                            <div class="fd-cnt">
                                <p class="fd-txt">{{ postDetailModel.text }}</p>

                                <a href="" @click.prevent="openPhotoViewer">
                                    <!-- start: attach 에 이미지파일이 있는 경우 -->
                                    <list-in-img-preview :file-items="postDetailModel.attachment"
                                                         location="location"></list-in-img-preview>
                                    <!-- end: attach 에 이미지파일이 있는 경우 -->
                                </a>


                                 <!-- start: 투표가 있는 경우 -->
                                  <detail-in-vote-preview :items="postDetailModel.vote"
                                                   choices-list="vote_choices"
                                                   title="title"
                                                   choice="multi_choice"
                                                   finish-at="finishAt"
                                                   mode="anonymous_mode"></detail-in-vote-preview>
                                 <!-- end: 투표가 있는 경우 -->

                                <!-- start: 링크가 있는 경우-->
                              <list-in-link-preview
                                      :file-items="postDetailModel.link"
                                      title="title"
                                      url="url" children="link_items"></list-in-link-preview>
                                <!-- end: 링크가 있는 경우 -->

                                <!-- start: attach 에 이미지 말고 다른 확장자를 가진 파일 즉 첨부파일인 경우 -->
                              <list-in-file-preview :file-items="postDetailModel.attachment" name="originalname" location="location"></list-in-file-preview>
                                <!-- end: attach 에 이미지 말고 다른 확장자를 가진 파일 즉 첨부파일인 경우 -->

                            </div>
                        </div>

                        <div class="popup-feed-comment">
                            <div class="comment-top">
                                <p>댓글 {{ commentItemsModel.length }}</p>
                            </div>
                            <div class="comment-cnt">
                                <div v-for="(item, idx ) in commentItemsModel" class="comment pdt-0" :key="`comment-${idx}`">
                                    <div class="main-comment">
                                        <p class="comment-writer">{{ item.owner ? item.owner.nickname : '주인없음' }} <span class="wr-time">{{ updatedDiffDate(item.createdAt) }}</span></p>
                                        <p class="comment-txt">{{ item.comment }}</p>
                                        <div class="modify-comment">
                                          <input v-model="tempComment" type="text" class="form-control popup-type sm" placeholder="댓글을 작성해 주세요." style="width:466px;">
                                          <a href="" class="txt-btn ft-14" :class="{'disabled': item.comment===tempComment}" @click.prevent="submitCommentModify(item.id, tempComment)">등록</a>
                                        </div>
                                        <div class="reply-state">
                                            <a href="" class="txt-btn ft-14" @click.prevent style="cursor:default">답글 {{ item.reply_count }}</a>
                                            <a href="" class="txt-btn ft-14" @click.prevent="replyInputToggle(idx)">답글달기</a>
                                            <a href="" class="txt-btn ft-14 modify" @click.prevent="openCommentModify(item, idx)">수정</a>
                                            <a href="" class="txt-btn ft-14 delete" @click.prevent="deleteComment(item)">삭제</a>
                                        </div>
                                    </div>

                                   <template v-if="replyItemsModel[idx]!==undefined">
                                     <div v-for="( replyItem, jdx) in replyItemsModel[idx].comment_list" class="reply" :key="`reply-${jdx}`">
                                       <p class="comment-writer">{{ replyItem.owner.nickname }} <span class="wr-time">{{ updatedDiffDate(replyItem.createdAt) }}</span></p>
                                       <p class="comment-txt">{{ replyItem.comment }}</p>
                                       <div class="modify-reply">
                                         <input v-model="tempReply" type="text" class="form-control popup-type sm" placeholder="댓글을 작성해 주세요." style="width:466px;">
                                         <a href="" class="txt-btn ft-14" :class="{'disabled': replyItem.comment===tempReply}" @click.prevent="submitReplyModify(replyItem.id, tempReply)">등록</a>
                                       </div>

                                       <div class="reply-state">
                                         <a href="" class="txt-btn ft-14 modify" @click.prevent="openReplyModify(replyItem, jdx)">수정</a>
                                         <a href="" class="txt-btn ft-14 delete" @click.prevent="deleteReply(replyItem)">삭제</a>
                                       </div>
                                     </div>
                                   </template>

                                    <div class="comment-btm reply hide">
                                        <input v-model="reply" type="text" class="form-control popup-type sm" placeholder="댓글을 작성해 주세요." style="width:466px;">
                                        <a href="" class="txt-btn ft-14" :class="{'disabled': reply===''}" @click.prevent="addReply(item.id)">등록</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div slot="footer">
                        <div class="comment-btm">
                            <button type="button" class="btn only-ico-btn"><img :src="require('@/assets/images/image.svg')" alt=""></button>
                            <input v-model="comment" type="text" class="form-control popup-type sm" placeholder="댓글을 작성해 주세요." style="width:466px;">
                            <a href="" class="txt-btn ft-14" :class="{'disabled': comment===''}" @click.prevent="addComment">등록</a>
                        </div>
                    </div>
                </div>
            </template>

        </modal>
        <!-- end: 공통 팝업 -->

    </transition>

    <photo-viewer v-if="isPhotoViewer" :is-photo-viewer="isPhotoViewer" :img-data="getImgFileDataSort(postDetailModel.attachment)" @change="onPhotoViewerStatus"></photo-viewer>
</div>
